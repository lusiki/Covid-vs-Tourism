event.window = 5,
type = "None",
to.remap = TRUE,
remap = "cumsum",
inference = TRUE,
inference.strategy = "bootstrap")
plot(es)
SplitD <- data.frame(name=colnames(rates),
when = rep(as.Date("2020-02-21"),12))
Returns <- na.omit(rates)
es <- eventstudy(firm.returns = Returns,
event.list = SplitD,
event.window = 5,
type = "None",
to.remap = TRUE,
remap = "cumsum",
inference = TRUE,
inference.strategy = "bootstrap")
plot(es)
SplitD
Returns
str(Returns)
par(mfrow=c(1,2))
plot(es1)
plot(es2)
par(mfrow=c(1,2))
plot(es1)
es1 <- eventstudy(firm.returns = Returns,
event.list = SplitD,
event.window = 5,
type = "None",
to.remap = TRUE,
remap = "cumsum",
inference = TRUE,
inference.strategy = "bootstrap")
SplitD <- data.frame(name=colnames(rates),
when = rep(as.Date("2020-03-11"),12))
Returns <- na.omit(rates)
es2 <- eventstudy(firm.returns = Returns,
event.list = SplitD,
event.window = 5,
type = "None",
to.remap = TRUE,
remap = "cumsum",
inference = TRUE,
inference.strategy = "bootstrap")
par(mfrow=c(1,2))
plot(es1)
plot(es2)
?plot
plot(es1, main = "Event study for the first COVID19 incidence in Italy"))
plot(es2)
plot(es1, main = "Event study for the first COVID19 incidence in Italy")
par(mfrow=c(1,2))
plot(es1, main = "Event study for the first COVID19 incidence in Italy")
plot(es2)
plot(es1, main = "Event study for the first COVID19 incidence in Italy")
plot(es1, main = "Event study for the first COVID19 incidence in Italy", xlab = "")
plot(es2)
es2
str(es2)
data("SplitDates", package = "eventstudies")
data("StockPriceReturns", package = "eventstudies")
data("OtherReturns", package = "eventstudies")
es <- eventstudies::eventstudy(firm.returns = StockPriceReturns,
event.list = SplitDates,
event.window = 7,
type = "marketModel",
to.remap = TRUE,
remap = "cumsum",
inference = TRUE,
inference.strategy = "bootstrap",
model.args = list(
market.returns = OtherReturns[, "NiftyIndex"]
)
)
plot(es)
plot(es, col="black")
plot(es, col="black")
es2$result
es2$outcomes
result <- es2$result
reuslt
result
str(result)
result <- as.data.frame(es2$result)
result
str(result)
result1 <- as.data.frame(es1$result)
result1 <- as.data.frame(es1$result) %>% mutate(Event Date = seq(-5:5,1))
result1 <- as.data.frame(es1$result) %>% mutate(EventDate = seq(-5:5,1))
result1 <- as.data.frame(es1$result) %>% mutate(EventDate = seq(-5,5,1))
result1 <- as.data.frame(es1$result) %>% mutate(EventDate = seq(-5,4,1))
result1
es1
str(es1)
result1 <- as.data.frame(es1$result) %>% mutate(EventDate = seq(-4,5,1))
result1
ggplot(result1,aes(EventDate, Mean)) +
geom_line()
result1
ggplot(result1,aes(EventDate, Mean)) +
geom_line()
ggplot(result1,aes(X = EventDate)) +
geom_line(aes(y=Mean))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y="2.5%"))
result1
names(result1)
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y="2.5%"))
geom_line(aes(y=`2.5%`)
ggplot(result1,aes(x = EventDate)) +
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=´2.5%´))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y="Mean"))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean))
result1 <- as.data.frame(es1$result) %>% mutate(EventDate = seq(-4,5,1)) %>% rename(ci1 = "2.5%")
result1
result1 <- as.data.frame(es1$result) %>% mutate(EventDate = seq(-4,5,1)) %>% rename(ci1 = "2.5%",ci2 = "97.5")
result1 <- as.data.frame(es1$result) %>% mutate(EventDate = seq(-4,5,1)) %>% rename(ci1 = "2.5%",ci2 = "97.5%")
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash")
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0)
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0)
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_x_discrete(name ="Event Day",
limits=c("-4","-2","0","2","4"))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_x_discrete(name ="Event Day")
limits=c("-4","4"))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_x_discrete(name ="Event Day",
limits=c("-4","4"))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
ylabel("Cum chnage in response series")
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day")
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,size=0.8)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,size=0.3)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,size=0.3)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,size=0.1)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day") +
theme_bw()
result1 <- as.data.frame(es1$result) %>% mutate(EventDate = seq(-4,5,1)) %>% rename(ci1 = "2.5%",ci2 = "97.5%")
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %",limits=c(-0.5, 0.5)) +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %",limits=c(-0.05, 0.05)) +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %",limits=c(-0.05, 0.05)) +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash")
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0)
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %",limits=c(-0.01, 0.01)) +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %",limits=c(-0.075, 0.075)) +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %",limits=c(-0.01, 0.075)) +
scale_x_discrete(name ="Event Day") +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0)
"4")) +
ggplot(result1,aes(x = EventDate)) +
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day",(breaks=1:5,
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day",breaks=1:5,
labels=c("-4", "-2", "0", "2","4")) +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_discrete(name ="Event Day", breaks=1:5,
labels=c("-4", "-2", "0", "2","4")) +
theme_bw()
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day", breaks=1:5,
labels=c("-4", "-2", "0", "2","4")) +
theme_bw()
result1
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day")
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day",breaks = 4)
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day")
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day",labels=c("-4", "-2", "0", "2","4"))
ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day",labels=c("-4", "-2", "0", "2","4")) +
theme_bw() +
ggtitle("Event study for the first COVID19 incidence in Italy")
result2 <- as.data.frame(es2$result) %>%
mutate(EventDate = seq(-4,5,1)) %>%
rename(ci1 = "2.5%",ci2 = "97.5%")
gg2 <- ggplot(result2,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day",labels=c("-4", "-2", "0", "2","4")) +
theme_bw() +
ggtitle("")
gg2
gg2 <- ggplot(result2,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
#  geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day",labels=c("-4", "-2", "0", "2","4")) +
theme_bw() +
ggtitle("")
gg2
gg2
library(patchwork)
gg1+gg2
gg1 <- ggplot(result1,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day",labels=c("-4", "-2", "0", "2","4")) +
theme_bw() +
ggtitle("")
gg1+gg2
es3 <- eventstudy(firm.returns = Returns,
event.list = SplitD,
event.window = 5,
type = "marketModel",
to.remap = TRUE,
remap = "cumsum",
inference = TRUE,
inference.strategy = "bootstrap",
model.args = list(market.returns=rates_indx$Crobex))
result3 <- as.data.frame(es3$result) %>%
mutate(EventDate = seq(-4,5,1)) %>%
rename(ci1 = "2.5%",ci2 = "97.5%")
gg3 <- ggplot(result3,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
#  geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day",labels=c("-4", "-2", "0", "2","4")) +
theme_bw() +
ggtitle("")
gg3
SplitD <- data.frame(name=colnames(rates),
when = rep(as.Date("2020-03-11"),12))
es4 <- eventstudy(firm.returns = Returns,
event.list = SplitD,
event.window = 5,
type = "marketModel",
to.remap = TRUE,
remap = "cumsum",
inference = TRUE,
inference.strategy = "bootstrap",
model.args = list(market.returns=rates_indx$Crobex))
result4 <- as.data.frame(es4$result) %>%
mutate(EventDate = seq(-4,5,1)) %>%
rename(ci1 = "2.5%",ci2 = "97.5%")
gg4 <- ggplot(result3,aes(x = EventDate)) +
geom_line(aes(y=Mean,)) +
geom_line(aes(y=ci1), linetype="twodash") +
geom_line(aes(y=ci2), linetype="twodash") +
geom_vline(xintercept=0) +
geom_hline(yintercept = 0) +
scale_y_continuous(name="Cum change in response series %") +
scale_x_continuous(name ="Event Day",labels=c("-4", "-2", "0", "2","4")) +
theme_bw() +
ggtitle("")
gg4
gg3
.$dr == "2019-01-03" ~ "Pre",
market %>%
mutate(dr = cut(Date, breaks = c(range(Date),
as.Date(c("2020-02-12", "2020-04-08","2021-04-15"))), include.lowest=TRUE)) %>% #View()
mutate(Pandemic =  case_when(
.$dr == "2019-01-03" ~ "Pre",
.$dr == "2020-02-12" ~ "Ongoing",
.$dr == "2020-04-08" ~ "Post")) %>%  #
filter(Date < "2021-04-15") %>%
select(-dr) %>% arrange (Date) %>%  #
group_by(Pandemic, Index) %>%
summarise("Total return" = sum(Return),
Return_avg = mean(Return),
Return_sd = sd(Return),
Return_min = min(Return),
Return_max = max(Return)) %>%
mutate_if(is.numeric, round, 3) %>% kable(caption = "Table 1: Overview of the market reaction to COVID-19 pandemic")
We investigate the effect of the spread of the pandemic into Europe on the tourist stocks in Croata!
